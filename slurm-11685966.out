I CMT_CPBP 12-01 22:46:15.276 run.py:58] get loaders
I CMT_CPBP 12-01 22:46:15.665 run.py:64] build graph, criterion, optimizer and trainer
I CMT_CPBP 12-01 22:46:17.862 run.py:103] start training
I CMT_CPBP 12-01 22:46:17.862 trainer.py:114] -1
I CMT_CPBP 12-01 22:46:17.862 trainer.py:115] True
I CMT_CPBP 12-01 22:46:17.862 trainer.py:55] loading model
I CMT_CPBP 12-01 22:46:18.070 trainer.py:79] restore rhythm model
I CMT_CPBP 12-01 22:46:18.071 trainer.py:120] 
I CMT_CPBP 12-01 22:46:18.071 trainer.py:121] 1 epoch
I CMT_CPBP 12-01 22:46:18.071 trainer.py:124] ==========train 1 epoch==========
I CMT_CPBP 12-01 22:46:32.989 utils.py:43] nll/train: 24.0446
I CMT_CPBP 12-01 22:46:32.989 utils.py:43] nll_pitch/train: 23.7821
I CMT_CPBP 12-01 22:46:32.989 utils.py:43] nll_rhythm/train: 0.2624
I CMT_CPBP 12-01 22:46:32.990 utils.py:45] accuracy_rhythm/train: 0.8906
I CMT_CPBP 12-01 22:46:32.990 utils.py:45] accuracy_pitch/train: 0.0786
I CMT_CPBP 12-01 22:46:32.993 trainer.py:129] ==========valid 1 epoch==========
I CMT_CPBP 12-01 22:46:34.048 utils.py:43] nll/eval: 8.7548
I CMT_CPBP 12-01 22:46:34.048 utils.py:43] nll_pitch/eval: 8.5573
I CMT_CPBP 12-01 22:46:34.048 utils.py:43] nll_rhythm/eval: 0.1975
I CMT_CPBP 12-01 22:46:34.048 utils.py:45] accuracy_rhythm/eval: 0.9148
I CMT_CPBP 12-01 22:46:34.048 utils.py:45] accuracy_pitch/eval: 0.1850
I CMT_CPBP 12-01 22:46:34.049 trainer.py:120] 
I CMT_CPBP 12-01 22:46:34.049 trainer.py:121] 2 epoch
I CMT_CPBP 12-01 22:46:34.049 trainer.py:124] ==========train 2 epoch==========
I CMT_CPBP 12-01 22:46:37.249 utils.py:43] nll/train: 14.3272
I CMT_CPBP 12-01 22:46:37.250 utils.py:43] nll_pitch/train: 14.0932
I CMT_CPBP 12-01 22:46:37.250 utils.py:43] nll_rhythm/train: 0.2340
I CMT_CPBP 12-01 22:46:37.250 utils.py:45] accuracy_rhythm/train: 0.9027
I CMT_CPBP 12-01 22:46:37.250 utils.py:45] accuracy_pitch/train: 0.1372
I CMT_CPBP 12-01 22:46:37.251 trainer.py:129] ==========valid 2 epoch==========
I CMT_CPBP 12-01 22:46:37.706 utils.py:43] nll/eval: 5.8276
I CMT_CPBP 12-01 22:46:37.706 utils.py:43] nll_pitch/eval: 5.6450
I CMT_CPBP 12-01 22:46:37.706 utils.py:43] nll_rhythm/eval: 0.1826
I CMT_CPBP 12-01 22:46:37.706 utils.py:45] accuracy_rhythm/eval: 0.9178
I CMT_CPBP 12-01 22:46:37.706 utils.py:45] accuracy_pitch/eval: 0.2302
I CMT_CPBP 12-01 22:46:37.707 trainer.py:120] 
I CMT_CPBP 12-01 22:46:37.707 trainer.py:121] 3 epoch
I CMT_CPBP 12-01 22:46:37.707 trainer.py:124] ==========train 3 epoch==========
I CMT_CPBP 12-01 22:46:40.833 utils.py:43] nll/train: 10.7909
I CMT_CPBP 12-01 22:46:40.833 utils.py:43] nll_pitch/train: 10.5797
I CMT_CPBP 12-01 22:46:40.833 utils.py:43] nll_rhythm/train: 0.2112
I CMT_CPBP 12-01 22:46:40.833 utils.py:45] accuracy_rhythm/train: 0.9108
I CMT_CPBP 12-01 22:46:40.833 utils.py:45] accuracy_pitch/train: 0.1611
I CMT_CPBP 12-01 22:46:40.834 trainer.py:129] ==========valid 3 epoch==========
I CMT_CPBP 12-01 22:46:41.031 utils.py:43] nll/eval: 4.7299
I CMT_CPBP 12-01 22:46:41.031 utils.py:43] nll_pitch/eval: 4.5669
I CMT_CPBP 12-01 22:46:41.031 utils.py:43] nll_rhythm/eval: 0.1630
I CMT_CPBP 12-01 22:46:41.031 utils.py:45] accuracy_rhythm/eval: 0.9273
I CMT_CPBP 12-01 22:46:41.031 utils.py:45] accuracy_pitch/eval: 0.2522
I CMT_CPBP 12-01 22:46:41.032 trainer.py:120] 
I CMT_CPBP 12-01 22:46:41.032 trainer.py:121] 4 epoch
I CMT_CPBP 12-01 22:46:41.032 trainer.py:124] ==========train 4 epoch==========
I CMT_CPBP 12-01 22:46:44.169 trainer.py:215] 100 training steps
I CMT_CPBP 12-01 22:46:44.169 utils.py:43] nll: 7.4811
I CMT_CPBP 12-01 22:46:44.170 utils.py:43] nll_pitch: 7.2826
I CMT_CPBP 12-01 22:46:44.170 utils.py:43] nll_rhythm: 0.1985
I CMT_CPBP 12-01 22:46:44.170 utils.py:45] accuracy_rhythm/train: 0.9124
I CMT_CPBP 12-01 22:46:44.170 utils.py:45] accuracy_pitch/train: 0.1983
I CMT_CPBP 12-01 22:46:44.170 utils.py:43] nll/train: 8.5801
I CMT_CPBP 12-01 22:46:44.170 utils.py:43] nll_pitch/train: 8.3838
I CMT_CPBP 12-01 22:46:44.170 utils.py:43] nll_rhythm/train: 0.1963
I CMT_CPBP 12-01 22:46:44.170 utils.py:45] accuracy_rhythm/train: 0.9158
I CMT_CPBP 12-01 22:46:44.170 utils.py:45] accuracy_pitch/train: 0.1831
I CMT_CPBP 12-01 22:46:44.171 trainer.py:129] ==========valid 4 epoch==========
I CMT_CPBP 12-01 22:46:44.315 utils.py:43] nll/eval: 3.7173
I CMT_CPBP 12-01 22:46:44.316 utils.py:43] nll_pitch/eval: 3.5515
I CMT_CPBP 12-01 22:46:44.316 utils.py:43] nll_rhythm/eval: 0.1658
I CMT_CPBP 12-01 22:46:44.316 utils.py:45] accuracy_rhythm/eval: 0.9257
I CMT_CPBP 12-01 22:46:44.316 utils.py:45] accuracy_pitch/eval: 0.3047
I CMT_CPBP 12-01 22:46:44.316 trainer.py:120] 
I CMT_CPBP 12-01 22:46:44.316 trainer.py:121] 5 epoch
I CMT_CPBP 12-01 22:46:44.317 trainer.py:124] ==========train 5 epoch==========
I CMT_CPBP 12-01 22:46:47.321 utils.py:43] nll/train: 6.8250
I CMT_CPBP 12-01 22:46:47.321 utils.py:43] nll_pitch/train: 6.6366
I CMT_CPBP 12-01 22:46:47.321 utils.py:43] nll_rhythm/train: 0.1885
I CMT_CPBP 12-01 22:46:47.321 utils.py:45] accuracy_rhythm/train: 0.9178
I CMT_CPBP 12-01 22:46:47.321 utils.py:45] accuracy_pitch/train: 0.2172
I CMT_CPBP 12-01 22:46:47.323 trainer.py:129] ==========valid 5 epoch==========
I CMT_CPBP 12-01 22:46:47.421 utils.py:43] nll/eval: 3.1976
I CMT_CPBP 12-01 22:46:47.421 utils.py:43] nll_pitch/eval: 3.0404
I CMT_CPBP 12-01 22:46:47.421 utils.py:43] nll_rhythm/eval: 0.1572
I CMT_CPBP 12-01 22:46:47.421 utils.py:45] accuracy_rhythm/eval: 0.9269
I CMT_CPBP 12-01 22:46:47.421 utils.py:45] accuracy_pitch/eval: 0.3471
I CMT_CPBP 12-01 22:46:47.421 trainer.py:120] 
I CMT_CPBP 12-01 22:46:47.422 trainer.py:121] 6 epoch
I CMT_CPBP 12-01 22:46:47.422 trainer.py:124] ==========train 6 epoch==========
I CMT_CPBP 12-01 22:46:50.153 utils.py:43] nll/train: 5.4830
I CMT_CPBP 12-01 22:46:50.154 utils.py:43] nll_pitch/train: 5.2989
I CMT_CPBP 12-01 22:46:50.154 utils.py:43] nll_rhythm/train: 0.1840
I CMT_CPBP 12-01 22:46:50.154 utils.py:45] accuracy_rhythm/train: 0.9199
I CMT_CPBP 12-01 22:46:50.154 utils.py:45] accuracy_pitch/train: 0.2589
I CMT_CPBP 12-01 22:46:50.155 trainer.py:129] ==========valid 6 epoch==========
I CMT_CPBP 12-01 22:46:50.243 utils.py:43] nll/eval: 2.7937
I CMT_CPBP 12-01 22:46:50.243 utils.py:43] nll_pitch/eval: 2.6315
I CMT_CPBP 12-01 22:46:50.243 utils.py:43] nll_rhythm/eval: 0.1622
I CMT_CPBP 12-01 22:46:50.243 utils.py:45] accuracy_rhythm/eval: 0.9262
I CMT_CPBP 12-01 22:46:50.243 utils.py:45] accuracy_pitch/eval: 0.3923
I CMT_CPBP 12-01 22:46:50.243 trainer.py:120] 
I CMT_CPBP 12-01 22:46:50.244 trainer.py:121] 7 epoch
I CMT_CPBP 12-01 22:46:50.244 trainer.py:124] ==========train 7 epoch==========
I CMT_CPBP 12-01 22:46:52.977 utils.py:43] nll/train: 4.3422
I CMT_CPBP 12-01 22:46:52.977 utils.py:43] nll_pitch/train: 4.1605
I CMT_CPBP 12-01 22:46:52.977 utils.py:43] nll_rhythm/train: 0.1818
I CMT_CPBP 12-01 22:46:52.977 utils.py:45] accuracy_rhythm/train: 0.9209
I CMT_CPBP 12-01 22:46:52.977 utils.py:45] accuracy_pitch/train: 0.3053
I CMT_CPBP 12-01 22:46:52.978 trainer.py:129] ==========valid 7 epoch==========
I CMT_CPBP 12-01 22:46:53.060 utils.py:43] nll/eval: 2.2853
I CMT_CPBP 12-01 22:46:53.060 utils.py:43] nll_pitch/eval: 2.1260
I CMT_CPBP 12-01 22:46:53.060 utils.py:43] nll_rhythm/eval: 0.1593
I CMT_CPBP 12-01 22:46:53.060 utils.py:45] accuracy_rhythm/eval: 0.9266
I CMT_CPBP 12-01 22:46:53.060 utils.py:45] accuracy_pitch/eval: 0.4606
I CMT_CPBP 12-01 22:46:53.060 trainer.py:120] 
I CMT_CPBP 12-01 22:46:53.061 trainer.py:121] 8 epoch
I CMT_CPBP 12-01 22:46:53.061 trainer.py:124] ==========train 8 epoch==========
I CMT_CPBP 12-01 22:46:55.789 trainer.py:215] 200 training steps
I CMT_CPBP 12-01 22:46:55.789 utils.py:43] nll: 3.1605
I CMT_CPBP 12-01 22:46:55.790 utils.py:43] nll_pitch: 2.9843
I CMT_CPBP 12-01 22:46:55.790 utils.py:43] nll_rhythm: 0.1762
I CMT_CPBP 12-01 22:46:55.790 utils.py:45] accuracy_rhythm/train: 0.9253
I CMT_CPBP 12-01 22:46:55.790 utils.py:45] accuracy_pitch/train: 0.3766
I CMT_CPBP 12-01 22:46:55.790 utils.py:43] nll/train: 3.4823
I CMT_CPBP 12-01 22:46:55.790 utils.py:43] nll_pitch/train: 3.3034
I CMT_CPBP 12-01 22:46:55.790 utils.py:43] nll_rhythm/train: 0.1789
I CMT_CPBP 12-01 22:46:55.790 utils.py:45] accuracy_rhythm/train: 0.9220
I CMT_CPBP 12-01 22:46:55.790 utils.py:45] accuracy_pitch/train: 0.3528
I CMT_CPBP 12-01 22:46:55.791 trainer.py:129] ==========valid 8 epoch==========
I CMT_CPBP 12-01 22:46:55.867 utils.py:43] nll/eval: 1.9869
I CMT_CPBP 12-01 22:46:55.867 utils.py:43] nll_pitch/eval: 1.8270
I CMT_CPBP 12-01 22:46:55.867 utils.py:43] nll_rhythm/eval: 0.1599
I CMT_CPBP 12-01 22:46:55.867 utils.py:45] accuracy_rhythm/eval: 0.9266
I CMT_CPBP 12-01 22:46:55.867 utils.py:45] accuracy_pitch/eval: 0.4823
I CMT_CPBP 12-01 22:46:55.868 trainer.py:120] 
I CMT_CPBP 12-01 22:46:55.868 trainer.py:121] 9 epoch
I CMT_CPBP 12-01 22:46:55.869 trainer.py:124] ==========train 9 epoch==========
I CMT_CPBP 12-01 22:46:58.605 utils.py:43] nll/train: 2.8832
I CMT_CPBP 12-01 22:46:58.606 utils.py:43] nll_pitch/train: 2.7055
I CMT_CPBP 12-01 22:46:58.606 utils.py:43] nll_rhythm/train: 0.1776
I CMT_CPBP 12-01 22:46:58.606 utils.py:45] accuracy_rhythm/train: 0.9226
I CMT_CPBP 12-01 22:46:58.606 utils.py:45] accuracy_pitch/train: 0.3906
I CMT_CPBP 12-01 22:46:58.607 trainer.py:129] ==========valid 9 epoch==========
I CMT_CPBP 12-01 22:46:58.679 utils.py:43] nll/eval: 1.8705
I CMT_CPBP 12-01 22:46:58.679 utils.py:43] nll_pitch/eval: 1.7075
I CMT_CPBP 12-01 22:46:58.679 utils.py:43] nll_rhythm/eval: 0.1631
I CMT_CPBP 12-01 22:46:58.679 utils.py:45] accuracy_rhythm/eval: 0.9249
I CMT_CPBP 12-01 22:46:58.679 utils.py:45] accuracy_pitch/eval: 0.5107
I CMT_CPBP 12-01 22:46:58.679 trainer.py:120] 
I CMT_CPBP 12-01 22:46:58.680 trainer.py:121] 10 epoch
I CMT_CPBP 12-01 22:46:58.680 trainer.py:124] ==========train 10 epoch==========
I CMT_CPBP 12-01 22:47:01.424 utils.py:43] nll/train: 2.4704
I CMT_CPBP 12-01 22:47:01.424 utils.py:43] nll_pitch/train: 2.2935
I CMT_CPBP 12-01 22:47:01.424 utils.py:43] nll_rhythm/train: 0.1768
I CMT_CPBP 12-01 22:47:01.424 utils.py:45] accuracy_rhythm/train: 0.9223
I CMT_CPBP 12-01 22:47:01.425 utils.py:45] accuracy_pitch/train: 0.4185
I CMT_CPBP 12-01 22:47:01.426 trainer.py:129] ==========valid 10 epoch==========
I CMT_CPBP 12-01 22:47:01.494 utils.py:43] nll/eval: 1.6516
I CMT_CPBP 12-01 22:47:01.495 utils.py:43] nll_pitch/eval: 1.4980
I CMT_CPBP 12-01 22:47:01.495 utils.py:43] nll_rhythm/eval: 0.1536
I CMT_CPBP 12-01 22:47:01.495 utils.py:45] accuracy_rhythm/eval: 0.9274
I CMT_CPBP 12-01 22:47:01.495 utils.py:45] accuracy_pitch/eval: 0.5236
I CMT_CPBP 12-01 22:47:01.495 trainer.py:83] saving model, Epoch 10, step 250
ARGS
Namespace(gpu_index=0, idx=2, load_rhythm=True, ngpu=1, optim_name='adam', restore_epoch=-1, sample=False, seed=42)
CONFIG
{'path': './pkl_files/instance_pkl_8bars_fpb12_48p_ckey', 'loader': {'num_workers': 8, 'batch_size': 64, 'shuffle': True, 'drop_last': True, 'pin_memory': True}, 'dataset': {'data_ratio': [0.8, 0.1, 0.1], 'num_worker': 4}}
Traceback (most recent call last):
  File "/home/lidem/projects/def-pesantg/lidem/CMT_CPBP/run.py", line 104, in <module>
    trainer.train(restore_epoch=args.restore_epoch, load_rhythm=args.load_rhythm)
  File "/lustre06/project/6032307/lidem/CMT_CPBP/trainer.py", line 134, in train
    self._sampling(epoch)
  File "/lustre06/project/6032307/lidem/CMT_CPBP/trainer.py", line 241, in _sampling
    indices = random.sample(range(len(loader.dataset)), self.config["num_sample"])
  File "/cvmfs/soft.computecanada.ca/gentoo/2020/usr/lib/python3.7/random.py", line 321, in sample
    raise ValueError("Sample larger than population or is negative")
ValueError: Sample larger than population or is negative
